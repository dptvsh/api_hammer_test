# Тестовое задание Hammer Systems на позицию Python разработчика

Необходимо было реализовать простую реферальную систему с минимальным интерфейсом для тестирования.

## Стек технологий

- Django
- Django Rest Framework
- PostgreSQL
- Docker

## Что уже выполнено:

- Авторизация и регистрация по номеру телефона с имитацией отправки кода подтверждения. В качестве дополнительно меры безопасности код подтверждения действителен лишь 5 минут.
- По полученному коду подтверждения пользователь получает токен и входит в систему.
- При первом входе в сервис каждому пользователю присваивается уникальный инвайт-код, который может ввести у себя в профиле другой пользователь.
- В профиле пользователя показывается список тех, кто ввел его инвайт-код.
- Была написана кастомная модель пользователя, а также был переопределен менеджер создания пользователя и суперпользователя.
- Написана коллекция Postman запросов, чтобы можно было убедиться, что все эндпоинты рабочие.
- Проект развернут по адресу [dptvsh.pythonanywhere.com](https://dptvsh.pythonanywhere.com/api/v1/) для наглядности и облегчения тестирования (используется SQLite из-за особенностей платформы).

## Что можно еще улучшить:

- Использовать Docker для контейнеризации и docker-compose для облегчения развертывания как локально, так и на сервере.
- Расширить коллекцию Postman запросов, добавив тесты для отслеживания учтенных вариантов исключений.
- Добавить более удобный интерфейс.

## Как развернуть проект локально с помощью Docker

1. Клонировать репозиторий и перейти в него в командной строке:

   ```git clone https://github.com/dptvsh/api_hammer_test.git```

   ```cd api_hammer_test```

2. Создать и заполнить .env файл по образцу из .env.example. Созданный файл .env должен находиться в той же директории, что и образец.

3. Запустить контейнеры в фоновом режиме:
  
   ```docker compose up -d```

4. Последовательно собрать и скопировать статику:

   ```docker compose exec backend python manage.py collectstatic```

   ```docker compose exec backend cp -r /app/collected_static/. /backend_static/static/```

5. Применить миграции:

   ```docker compose exec backend python manage.py migrate```

6. Создать суперпользователя:

   ```docker compose exec backend python manage.py createsuperuser```

## Примеры API запросов и ответов

### 1. Авторизация

**Запрос кода:**
- `POST /api/auth/request_code/`

- Пример запроса:
  ```json
  {
      "phone_number": "+79123456789"
  }
  ```

- Пример ответа:
  ```json
  {
      "confirmation_code": "1234"
  }
  ```

**Проверка кода:**

- `POST /api/auth/auth_code/`
- Срок действия кода ограничен и составляет 5 минут

- Пример запроса:
  ``` json
    {
        "phone_number": "+79123456789",
        "confirmation_code": "1234"
    }
  ```
- Пример ответа:
  ``` json
    {
        "token": "<token>"
    }
  ```

### 2. Профиль пользователя

**Получение профиля:**

- `GET /api/profile/me/`
- Headers:

  - Authorization: Token <ваш_токен>

**Активация инвайт-кода:**

- `POST /api/profile/activate_invite/`
- Headers:

  - Authorization: Token <ваш_токен>

- Пример запроса:

  ```json
    {
        "invite_code": "ABC123"
    }
  ```